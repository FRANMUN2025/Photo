<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<style>
body{font-family:Arial,sans-serif;background:#111;color:white;display:flex;justify-content:center;padding:50px;}
.container{width:800px;background:rgba(0,0,0,0.85);padding:30px;border-radius:12px;}
input,button{padding:8px;margin:5px;border-radius:6px;border:none;}
button{background:#ff2d55;color:white;cursor:pointer;}
table{width:100%;border-collapse:collapse;margin-top:20px;}
th,td{padding:8px;border:1px solid #444;text-align:center;}
tr:nth-child(even){background:#222;}
a{color:#0af;text-decoration:none;}
a:hover{text-decoration:underline;}
</style>
</head>
<body>

<div class="container">
<h2>Admin Panel</h2>

<h3>Add New User</h3>
<input type="text" id="newUser" placeholder="Username">
<input type="password" id="newPass" placeholder="Password">
<button onclick="addUser()">Add User</button>

<h3>Users List</h3>
<table>
<tr><th>Username</th><th>Password</th><th>Approved</th><th>Actions</th></tr>
<tbody id="usersTable"></tbody>
</table>

<h3>Pending Requests</h3>
<table>
<tr><th>Username</th><th>Approved</th><th>Actions</th></tr>
<tbody id="requestsTable"></tbody>
</table>

<h3>Add Drive Link</h3>
<input type="text" id="linkName" placeholder="Album Name">
<input type="text" id="linkUrl" placeholder="Google Drive URL">
<button onclick="addDriveLink()">Add Link</button>

<h3>Drive Links</h3>
<table>
<tr><th>Name</th><th>URL</th><th>Actions</th></tr>
<tbody id="linksTable"></tbody>
</table>

</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
// ðŸ”¹ Firebase Config Ø§Ù„ØµØ­ÙŠØ­
const firebaseConfig = {
  apiKey: "AIzaSyDj2taqmuxvbUlLlwCV0DIp-x6FdwLAoE0",
  authDomain: "privategallery-e307b.firebaseapp.com",
  projectId: "privategallery-e307b",
  storageBucket: "privategallery-e307b.firebasestorage.app",
  messagingSenderId: "1028748741349",
  appId: "1:1028748741349:web:320660e8bfe36b7d87e20c",
  measurementId: "G-M5GCFL16Z4"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// ------------------ Users ------------------
// Add new user
function addUser(){
  const u = document.getElementById("newUser").value.trim();
  const p = document.getElementById("newPass").value.trim();
  if(!u||!p){alert("Enter username & password");return;}
  db.collection("users").doc(u).set({password:p, approved:true}).then(()=>{
    loadUsers();
    document.getElementById("newUser").value="";
    document.getElementById("newPass").value="";
  });
}

// Load users
function loadUsers(){
  const table = document.getElementById("usersTable");
  table.innerHTML="";
  db.collection("users").get().then(snapshot=>{
    snapshot.forEach(doc=>{
      const data = doc.data();
      const tr = document.createElement("tr");
      tr.innerHTML=`<td>${doc.id}</td><td>${data.password}</td><td>${data.approved}</td>
      <td>
        <button onclick="toggleApprove('${doc.id}',${data.approved})">Toggle Approve</button>
        <button onclick="deleteUser('${doc.id}')">Delete</button>
      </td>`;
      table.appendChild(tr);
    });
  });
}

// Toggle approval
function toggleApprove(id,current){
  db.collection("users").doc(id).update({approved:!current}).then(()=> loadUsers());
}

// Delete user
function deleteUser(id){
  if(confirm("Delete this user?")){
    db.collection("users").doc(id).delete().then(()=> loadUsers());
  }
}

// ------------------ Requests ------------------
// Load pending requests
// Load pending requests
function loadRequests(){
  const table = document.getElementById("requestsTable");
  table.innerHTML="";
  db.collection("requests").get().then(snapshot=>{
    snapshot.forEach(doc=>{
      const data = doc.data();
      const tr = document.createElement("tr");
      tr.innerHTML=`
      <td>${doc.id}</td>
      <td>${data.email}</td>
      <td>${data.approved}</td>
      <td>
        <button onclick="approveRequest('${doc.id}', '${data.email}')">Approve</button>
        <button onclick="deleteRequest('${doc.id}')">Delete</button>
      </td>`;
      table.appendChild(tr);
    });
  });
}

// Approve request
function approveRequest(name){
  db.collection("users").doc(name).set({password:"", approved:true}).then(()=>{
    db.collection("requests").doc(name).delete().then(()=>loadRequests());
    loadUsers();
  });
}

// Delete request
function deleteRequest(name){
  if(confirm("Delete this request?")){
    db.collection("requests").doc(name).delete().then(()=>loadRequests());
  }
}

// ------------------ Drive Links ------------------
function addDriveLink(){
  const name = document.getElementById("linkName").value.trim();
  const url = document.getElementById("linkUrl").value.trim();
  if(!name||!url){alert("Enter name & URL");return;}
  const docId = name.replace(/\s+/g,"_").toLowerCase();
  db.collection("driveLinks").doc(docId).set({name:name,url:url}).then(()=>{
    loadLinks();
    document.getElementById("linkName").value="";
    document.getElementById("linkUrl").value="";
  });
}

function loadLinks(){
  const table = document.getElementById("linksTable");
  table.innerHTML="";
  db.collection("driveLinks").get().then(snapshot=>{
    snapshot.forEach(doc=>{
      const data = doc.data();
      const tr = document.createElement("tr");
      tr.innerHTML=`<td>${data.name}</td><td><a href="${data.url}" target="_blank">${data.url}</a></td>
      <td><button onclick="deleteLink('${doc.id}')">Delete</button></td>`;
      table.appendChild(tr);
    });
  });
}

function deleteLink(id){
  if(confirm("Delete this link?")){
    db.collection("driveLinks").doc(id).delete().then(()=> loadLinks());
  }
}

// ------------------ Initial load ------------------
loadUsers();
loadRequests();
loadLinks();

</script>
</body>
</html>
